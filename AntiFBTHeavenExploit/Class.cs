using Harmony;
using MelonLoader;
using System.Reflection;
using UnityEngine;
using VRC;

namespace AntiFBTHeavenExploit
{
    public class Class : MelonMod
    {
        public override void OnApplicationStart()
        {
            IntializeHarmony();
            base.OnApplicationStart();
        }

        public static void IntializeHarmony()
        {
            var harmony = HarmonyInstance.Create("FemboyToesHarmony");
            try
            {
                harmony.Patch(typeof(ObjectInstantiator).GetMethod("_InstantiateObject"), new HarmonyMethod(typeof(Class).GetMethod("_InstantiateObjectPatch", BindingFlags.Static | BindingFlags.NonPublic)), null, null);
            }
            catch
            {
                MelonLogger.Msg("Patching failed! Most likely mod is outdated");
            }
        }

        private static bool _InstantiateObjectPatch(ref string __0, ref Vector3 __1, ref Quaternion __2, ref int __3, ref Player __4)
        {
            if (RoomManager.field_Internal_Static_ApiWorld_0.id == "wrld_d319c58a-dcec-47de-b5fc-21200116462c")
            {
                if (__0.StartsWith("Assets"))
                    return false;
            }

            return true;
        }
    }
}
